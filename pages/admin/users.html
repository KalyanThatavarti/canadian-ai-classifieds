<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Users Management - Canadian AI Classifieds Admin</title>
    <link rel="stylesheet" href="../../css/header.css">
    <link rel="stylesheet" href="../../css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div id="header-placeholder"></div>

    <main class="admin-container">
        <div class="admin-header">
            <a href="/pages/admin/index.html"
                style="display: inline-flex; align-items: center; gap: 8px; color: #6366f1; text-decoration: none; font-weight: 600; margin-bottom: 1rem;">‚Üê
                Back to Dashboard</a>
            <h1><i class="fas fa-users"></i> Users Management</h1>
            <p>Manage user accounts, view activity, and moderate users</p>
        </div>

        <!-- Search and Filters -->
        <div class="admin-filters">
            <div class="filter-group">
                <input type="text" id="userSearch" placeholder="Search by name, email, or ID..." class="filter-input">
                <i class="fas fa-search search-icon"></i>
            </div>

            <div class="filter-group">
                <label for="statusFilter">Status:</label>
                <select id="statusFilter" class="filter-select">
                    <option value="all">All Users</option>
                    <option value="active">Active</option>
                    <option value="banned">Banned</option>
                    <option value="suspended">Suspended</option>
                </select>
            </div>

            <div class="filter-group">
                <label for="sortBy">Sort:</label>
                <select id="sortBy" class="filter-select">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="mostListings">Most Listings</option>
                    <option value="mostReports">Most Reports</option>
                </select>
            </div>

            <button id="refreshBtn" class="btn-secondary">
                <i class="fas fa-sync-alt"></i> Refresh
            </button>
        </div>

        <!-- Stats Summary -->
        <div class="stats-grid">
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <div>
                    <h3 id="totalUsers">0</h3>
                    <p>Total Users</p>
                </div>
            </div>
            <div class="stat-card">
                <i class="fas fa-check-circle" style="color: #10b981;"></i>
                <div>
                    <h3 id="activeUsers">0</h3>
                    <p>Active</p>
                </div>
            </div>
            <div class="stat-card">
                <i class="fas fa-ban" style="color: #ef4444;"></i>
                <div>
                    <h3 id="bannedUsers">0</h3>
                    <p>Banned</p>
                </div>
            </div>
            <div class="stat-card">
                <i class="fas fa-pause-circle" style="color: #f59e0b;"></i>
                <div>
                    <h3 id="suspendedUsers">0</h3>
                    <p>Suspended</p>
                </div>
            </div>
        </div>

        <!-- Users Table -->
        <div class="admin-table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>User</th>
                        <th>Email</th>
                        <th>Joined</th>
                        <th>Listings</th>
                        <th>Reports</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="usersTableBody">
                    <!-- Users will be populated here -->
                </tbody>
            </table>

            <div id="emptyState" class="empty-state" style="display: none;">
                <i class="fas fa-users-slash"></i>
                <h3>No Users Found</h3>
                <p>Try adjusting your search or filters</p>
            </div>

            <div id="loadingState" class="loading-state">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Loading users...</p>
            </div>
        </div>
    </main>

    <!-- Ban User Modal -->
    <div id="banModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-ban"></i> Ban User</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <p>You are about to permanently ban <strong id="banUserName"></strong>.</p>
                <p class="warning-text">
                    <i class="fas fa-exclamation-triangle"></i>
                    This user will not be able to login or access the platform.
                </p>

                <div class="form-group">
                    <label for="banReason">Reason for ban: *</label>
                    <textarea id="banReason" rows="4" placeholder="Enter detailed reason for ban..."
                        required></textarea>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="deleteListings">
                    <label for="deleteListings">Also delete all user's listings</label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeBanModal()">Cancel</button>
                <button class="btn-danger" onclick="confirmBan()">
                    <i class="fas fa-ban"></i> Ban User
                </button>
            </div>
        </div>
    </div>

    <!-- Suspend User Modal -->
    <div id="suspendModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-pause-circle"></i> Suspend User</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <p>You are about to suspend <strong id="suspendUserName"></strong>.</p>

                <div class="form-group">
                    <label for="suspendDuration">Suspension Duration: *</label>
                    <select id="suspendDuration" required>
                        <option value="1">1 Day</option>
                        <option value="3">3 Days</option>
                        <option value="7">7 Days</option>
                        <option value="14">14 Days</option>
                        <option value="30">30 Days</option>
                        <option value="90">90 Days</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="suspendReason">Reason for suspension: *</label>
                    <textarea id="suspendReason" rows="4" placeholder="Enter detailed reason..." required></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeSuspendModal()">Cancel</button>
                <button class="btn-warning" onclick="confirmSuspend()">
                    <i class="fas fa-pause-circle"></i> Suspend User
                </button>
            </div>
        </div>
    </div>

    <!-- User Details Modal -->
    <div id="userDetailsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-user-circle"></i> User Details</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="userDetailsContent">
                    <!-- User details will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeUserDetailsModal()">Close</button>
            </div>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>

    <!-- Scripts -->
    <script src="../../js/firebase-config.js"></script>
    <script src="../../js/header.js"></script>
    <script src="../../js/admin-auth.js"></script>
    <script src="../../js/admin-users.js"></script>
</body>

</html>